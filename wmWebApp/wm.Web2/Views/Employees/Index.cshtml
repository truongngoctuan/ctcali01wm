@model IEnumerable<wm.Model.Employee>

@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>Index</h2>

<p>
    @Html.ActionLink("Create New", "Register", "Account")
</p>
<table class="table">
    <tr>
        <th>
            @Html.DisplayNameFor(model => model.Branch.Name)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Name)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Role)
        </th>
        <th></th>
    </tr>

@foreach (var item in Model) {
    <tr>
        <td>
            @Html.DisplayFor(modelItem => item.Branch.Name)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Name)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Role)
        </td>
        <td>
            @Html.ActionLink("Edit", "Edit", new { id=item.Id }) |
            @Html.ActionLink("Delete", "Delete", new { id=item.Id })
        </td>
    </tr>
}

</table>

<div class="row">
    <table id="exampleTable01" class="table">
        <thead>
            <tr>
                <th>
                    @Html.DisplayNameFor(model => model.Branch.Name)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.Name)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.Role)
                </th>
                <th>
                    Toolbox
                </th>
            </tr>
        </thead>
        <tfoot>
            <tr>
                <th>
                    @Html.DisplayNameFor(model => model.Branch.Name)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.Name)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.Role)
                </th>
                <th>
                    Toolbox
                </th>
            </tr>
        </tfoot>
    </table>
</div>

</section>
@section Scripts {
<script src="~/Content/crudHelper.js"></script>
    <script>
        $(document).ready(function () {

            document.oTable = $('#exampleTable01').DataTable({
                "serverSide": true,
                "ajax": {
                    "type": "POST",
                    "url": "@Url.Action("List")",
                    "contentType": 'application/json; charset=utf-8',
                    'data': function (data) { return data = JSON.stringify(data); }
                },
                "pagingType": "full_numbers",
                "processing": true,
                "paging": true,
                "deferRender": true,
                "columns": [
                { "data": "BranchName" },
                { "data": "Name" },
                { "data": "RoleName" },
                {
                    "data": "id", "orderable": false,
                    "render": function (data, type, full, meta) {
                        return type === 'display' &&
                            '<a href="@Url.Action("Details")/' + data + '" class="btn btn-primary btn-details">Details</a>'
                        + '<a href="@Url.Action("Edit")/' + data + '" class="btn btn-warning btn-edit">Edit</a>'
                            + '<a href="' + data + '" class="btn btn-danger btn-delete">Delete</a>';
                    }
                }
                ],
                "order": [0, "asc"]
            });

            document.oTable.on('draw.dt', function () {
                $(".btn-delete").click(function (e) {
                    var a_href = $(this).attr('href');
                    e.preventDefault();
                    callDeleteConfirmation({ "id": a_href }, '@Url.Action("Delete")');
                });
            });
        });

    </script>
}
